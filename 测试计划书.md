# 书海阁项目测试计划书

## 1. 测试目标

本测试计划旨在确保书海阁项目的核心功能符合设计规格，具有良好的稳定性和可靠性。具体目标如下：

- 验证图书管理系统的核心功能正确实现
- 检测边界条件和特殊输入情况下的系统行为
- 确保业务逻辑规则得到正确应用
- 评估代码质量和覆盖率

## 2. 测试范围

本测试计划涵盖书海阁项目中的四个核心功能模块：

1. 图书高级搜索功能
2. 图书收藏计数功能
3. 按收藏量排序功能
4. 图书详情获取功能

## 3. 测试策略

本测试计划采用黑盒测试与白盒测试相结合的策略：

### 3.1 黑盒测试策略

- **等价类划分**: 将输入数据划分为有效和无效等价类，每类选取代表性数据进行测试
- **边界值分析**: 针对边界值进行测试，如空值、最大值、最小值等
- **错误猜测法**: 根据经验设计可能导致错误的特殊输入
- **决策表测试**: 针对多条件组合的功能使用决策表设计测试用例

### 3.2 白盒测试策略

- **语句覆盖**: 确保每个代码语句至少执行一次
- **判定覆盖**: 确保每个判定语句的真假分支都至少执行一次
- **条件覆盖**: 确保每个条件表达式的所有可能结果都至少执行一次
- **路径覆盖**: 测试程序中的重要执行路径

## 4. 测试环境

- **硬件环境**: PC 或 Mac 开发机器
- **软件环境**:
  - JDK 17+
  - MySQL 8.0
  - Spring Boot 3.x
  - MyBatis-Plus
  - 浏览器: Chrome, Firefox, Safari最新版
- **测试工具**:
  - JUnit 5
  - Mockito
  - Postman
  - 浏览器开发者工具

## 5. 测试功能点与用例设计

### 5.1 图书高级搜索功能 (advancedSearch)

#### 功能描述
根据标题、作者、分类等多条件组合搜索图书，不同长度的搜索词采用不同的匹配策略。

#### 黑盒测试用例

| 测试ID | 测试名称 | 输入数据 | 预期结果 | 测试类型 |
|--------|----------|----------|----------|----------|
| TS-1.1 | 精确标题搜索-短标题 | title="Java", author="", category="" | 返回书名完全匹配"Java"的图书 | 等价类划分 |
| TS-1.2 | 前缀标题搜索-中等长度 | title="Spring", author="", category="" | 返回书名以"Spring"开头的图书 | 等价类划分 |
| TS-1.3 | 包含标题搜索-长标题 | title="JavaScript高级编程", author="", category="" | 返回书名包含"JavaScript高级编程"的图书 | 等价类划分 |
| TS-1.4 | 多条件组合搜索 | title="Java", author="Martin", category="编程" | 返回同时满足所有条件的图书 | 组合测试 |
| TS-1.5 | 空字符串搜索 | title="", author="", category="" | 返回所有图书 | 边界值分析 |
| TS-1.6 | 包含特殊字符搜索 | title="C#&.NET", author="", category="" | 正确处理特殊字符不抛出异常 | 错误猜测 |
| TS-1.7 | 超长字符串搜索 | title=300字符长文本, author="", category="" | 正确处理不抛出异常 | 边界值分析 |
| TS-1.8 | 空对象测试 | title=null, author=null, category=null | 返回所有图书不抛出异常 | 边界值分析 |

#### 白盒测试用例

| 测试ID | 测试名称 | 测试目标 | 覆盖类型 |
|--------|----------|----------|----------|
| TW-1.1 | 标题长度分支覆盖 | 测试不同标题长度下的分支选择 | 判定覆盖 |
| TW-1.2 | 标题为null的分支 | 测试标题为null时的处理分支 | 条件覆盖 |
| TW-1.3 | 多条件组合覆盖 | 测试多种条件组合下的路径 | 路径覆盖 |
| TW-1.4 | 分页边界处理 | 测试分页边界条件处理代码 | 语句覆盖 |
| TW-1.5 | 排序逻辑覆盖 | 测试更新时间排序逻辑 | 判定覆盖 |

### 5.2 图书收藏计数功能 (incrementFavoriteCount/decrementFavoriteCount)

#### 功能描述
增加或减少图书的收藏数量，包含业务规则限制和边界条件处理。

#### 黑盒测试用例

| 测试ID | 测试名称 | 输入数据 | 预期结果 | 测试类型 |
|--------|----------|----------|----------|----------|
| TS-2.1 | 正常增加收藏数 | 有效bookId, 当前收藏数<1000 | 收藏数+1，返回true | 等价类划分 |
| TS-2.2 | 收藏数达到上限 | 有效bookId, 当前收藏数=1000 | 收藏数不变，返回false | 边界值分析 |
| TS-2.3 | 图书不存在 | 无效bookId | 返回false | 等价类划分 |
| TS-2.4 | 收藏数为null | 有效bookId, 当前收藏数=null | 收藏数设为1，返回true | 边界值分析 |
| TS-2.5 | 正常减少收藏数 | 有效bookId, 当前收藏数>0 | 收藏数-1，返回true | 等价类划分 |
| TS-2.6 | 收藏数为0减少 | 有效bookId, 当前收藏数=0 | 收藏数不变，返回true | 边界值分析 |
| TS-2.7 | 非法ID测试 | bookId=0, bookId<0 | 返回false | 边界值分析 |
| TS-2.8 | ID为null测试 | bookId=null | 返回false | 错误猜测 |

#### 白盒测试用例

| 测试ID | 测试名称 | 测试目标 | 覆盖类型 |
|--------|----------|----------|----------|
| TW-2.1 | ID验证分支覆盖 | 测试ID验证的各分支 | 条件覆盖 |
| TW-2.2 | 收藏上限检查 | 测试收藏数达到上限的处理 | 判定覆盖 |
| TW-2.3 | 收藏数为null路径 | 测试收藏数为null时的处理路径 | 路径覆盖 |
| TW-2.4 | 收藏数为0路径 | 测试收藏数为0时减少的处理路径 | 路径覆盖 |
| TW-2.5 | 图书不存在路径 | 测试图书不存在时的处理 | 判定覆盖 |

### 5.3 按收藏量排序功能 (searchAndSortByFavoriteCount)

#### 功能描述
根据收藏量对图书进行排序，支持升序和降序，包含复杂的二级排序逻辑。

#### 黑盒测试用例

| 测试ID | 测试名称 | 输入数据 | 预期结果 | 测试类型 |
|--------|----------|----------|----------|----------|
| TS-3.1 | 收藏量降序排序 | sortType="desc", query="" | 收藏量高到低排序 | 等价类划分 |
| TS-3.2 | 收藏量升序排序 | sortType="asc", query="" | 收藏量低到高排序 | 等价类划分 |
| TS-3.3 | 收藏量相同时二级排序-降序 | sortType="desc", 数据中有相同收藏量 | 先按收藏量降序，相同时按更新时间降序 | 组合测试 |
| TS-3.4 | 收藏量相同时二级排序-升序 | sortType="asc", 数据中有相同收藏量 | 先按收藏量升序，相同时按书名升序 | 组合测试 |
| TS-3.5 | 带查询条件的排序 | sortType="desc", query="Java" | 满足查询条件后按收藏量降序 | 组合测试 |
| TS-3.6 | 分页边界测试 | page=非常大的数, size=10 | 返回首页数据 | 边界值分析 |
| TS-3.7 | 空结果集排序 | query="不存在的图书" | 返回空列表不抛异常 | 边界值分析 |
| TS-3.8 | 非法排序类型 | sortType="invalid" | 默认使用降序排序 | 错误猜测 |

#### 白盒测试用例

| 测试ID | 测试名称 | 测试目标 | 覆盖类型 |
|--------|----------|----------|----------|
| TW-3.1 | 排序类型分支覆盖 | 测试不同排序类型的处理分支 | 判定覆盖 |
| TW-3.2 | 二级排序逻辑覆盖 | 测试收藏量相同时的二级排序 | 条件覆盖 |
| TW-3.3 | 分页计算边界 | 测试分页边界条件计算 | 路径覆盖 |
| TW-3.4 | 空值处理覆盖 | 测试收藏量为null的处理 | 条件覆盖 |
| TW-3.5 | 查询条件过滤逻辑 | 测试查询条件过滤的各分支 | 语句覆盖 |

### 5.4 图书详情获取功能 (getBookDetail)

#### 功能描述
获取图书详情，并对数据进行规范化处理，确保数据的完整性和一致性。

#### 黑盒测试用例

| 测试ID | 测试名称 | 输入数据 | 预期结果 | 测试类型 |
|--------|----------|----------|----------|----------|
| TS-4.1 | 获取有效图书 | 有效bookId | 返回正确的图书信息 | 等价类划分 |
| TS-4.2 | 获取不存在的图书 | 不存在的bookId | 返回null | 等价类划分 |
| TS-4.3 | 非法ID测试 | bookId=0, bookId<0 | 返回null | 边界值分析 |
| TS-4.4 | ID为null测试 | bookId=null | 返回null | 错误猜测 |
| TS-4.5 | 作者为空测试 | 包含空作者的图书 | 返回作者字段为"未知作者" | 特殊值测试 |
| TS-4.6 | 类别为空测试 | 包含空类别的图书 | 返回类别字段为"未分类" | 特殊值测试 |
| TS-4.7 | 价格为负数测试 | 包含负价格的图书 | 返回价格为0.00 | 特殊值测试 |
| TS-4.8 | 价格为null测试 | 包含null价格的图书 | 返回价格为0.00 | 边界值分析 |

#### 白盒测试用例

| 测试ID | 测试名称 | 测试目标 | 覆盖类型 |
|--------|----------|----------|----------|
| TW-4.1 | ID验证分支覆盖 | 测试ID验证的各分支 | 条件覆盖 |
| TW-4.2 | 图书为null路径 | 测试图书不存在时的路径 | 判定覆盖 |
| TW-4.3 | 作者规范化分支 | 测试作者字段规范化各分支 | 路径覆盖 |
| TW-4.4 | 类别规范化分支 | 测试类别字段规范化各分支 | 路径覆盖 |
| TW-4.5 | 价格规范化分支 | 测试价格字段规范化各分支 | 条件覆盖 |

## 6. 测试优先级划分

基于功能重要性和风险评估，测试用例划分优先级：

- **高优先级**: TS-1.1, TS-1.4, TS-2.1, TS-2.5, TS-3.1, TS-3.5, TS-4.1
- **中优先级**: TS-1.2, TS-1.3, TS-2.2, TS-2.7, TS-3.2, TS-3.3, TS-4.2, TS-4.5
- **低优先级**: TS-1.5, TS-1.6, TS-1.7, TS-1.8, TS-2.3, TS-2.4, TS-2.6, TS-2.8, TS-3.4, TS-3.6, TS-3.7, TS-3.8, TS-4.3, TS-4.4, TS-4.6, TS-4.7, TS-4.8

## 7. 测试进度计划

| 阶段 | 任务 | 时间估计 |
|------|------|----------|
| 阶段1 | 测试环境搭建与配置 | 1天 |
| 阶段2 | 单元测试用例设计与编写 | 3天 |
| 阶段3 | 单元测试执行 | 2天 |
| 阶段4 | 集成测试用例设计与执行 | 2天 |
| 阶段5 | 系统测试执行 | 1天 |
| 阶段6 | 缺陷修复与回归测试 | 2天 |
| 阶段7 | 测试报告编写 | 1天 |

## 8. 风险评估与缓解措施

| 风险 | 影响 | 可能性 | 缓解措施 |
|------|------|--------|----------|
| 测试环境配置问题 | 中 | 中 | 提前准备测试环境文档和配置脚本 |
| 测试数据不足 | 高 | 中 | 准备充分的测试数据集，考虑边界情况 |
| 测试覆盖率不足 | 高 | 低 | 制定详细的测试用例，确保各类覆盖 |
| 代码修改导致回归 | 中 | 高 | 实施自动化回归测试 |
| 测试时间不足 | 高 | 中 | 优先测试核心功能，根据优先级安排 |

## 9. 测试交付物

- 测试计划书
- 测试用例文档
- 测试数据集
- 测试执行报告
- 缺陷报告
- 测试覆盖率报告
- 测试总结报告

## 10. 测试完成标准

- 所有高优先级测试用例均已执行
- 所有发现的严重和高优先级缺陷已修复
- 代码覆盖率达到80%以上
- 所有核心功能满足需求规格
- 测试报告已完成并通过审核

## 11. 附录

### 测试数据准备清单

1. 基础图书数据集（至少30本图书）
2. 各种边界条件图书数据（空作者、空类别、负价格、null值等）
3. 收藏量数据集（各种收藏量值，包括0、接近上限的值）
4. 特殊字符测试数据

### 单元测试框架代码示例

```java
@Test
public void testAdvancedSearch_ShortTitle() {
    // 准备测试数据
    Book book1 = new Book();
    book1.setId(1L);
    book1.setName("Java");
    book1.setAuthor("作者1");
    
    Book book2 = new Book();
    book2.setId(2L);
    book2.setName("JavaEE");
    book2.setAuthor("作者2");
    
    // 模拟数据库操作
    when(bookMapper.selectList(any())).thenReturn(Arrays.asList(book1, book2));
    
    // 执行测试
    IPage<Book> result = bookService.advancedSearch("Java", null, null, 1, 10);
    
    // 验证结果
    assertEquals(1, result.getRecords().size());
    assertEquals("Java", result.getRecords().get(0).getName());
}
``` 